import{c as v,j as e,C as h,S as _,f as S,e as I,r as d,T as u}from"./types-BOl6DAnX.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],k=v("chevron-right",y),w=o=>{const n=Math.floor(o/3600),i=Math.floor(o%3600/60),l=o%60;return n>0?`${n}h ${i}m`:i>0?`${i}m ${l}s`:`${l}s`},C=({currentTask:o,recentTasks:n,timer:i,isActive:l,onStartTask:m,onStopTask:c})=>e.jsxs("div",{className:"w-full h-full bg-zinc-900/95 backdrop-blur-2xl rounded-2xl shadow-2xl overflow-hidden border border-white/10",children:[e.jsxs("div",{className:"p-4 border-b border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-bold text-zinc-500 uppercase tracking-widest",children:"Now Active"}),l&&e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"})]}),o?e.jsxs("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-white font-semibold mb-1",children:o.name}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${o.tagColor} bg-opacity-20 text-white`,children:o.tag})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-zinc-400",children:[e.jsx(h,{size:14}),e.jsx("span",{className:"font-mono text-sm",children:w(i)})]}),e.jsx("button",{onClick:c,className:"p-2 bg-red-500/20 hover:bg-red-500/30 rounded-lg transition-all",children:e.jsx(_,{size:14,className:"text-red-400",fill:"currentColor"})})]})]}):e.jsx("div",{className:"bg-white/5 rounded-xl p-6 border border-white/10 text-center",children:e.jsx("p",{className:"text-zinc-500 text-sm italic",children:"No active task"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(h,{size:14,className:"text-zinc-500"}),e.jsx("span",{className:"text-xs font-bold text-zinc-500 uppercase tracking-widest",children:"Recents"})]}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:n.slice(0,5).map(s=>e.jsx("button",{onClick:()=>m(s.name),className:"w-full bg-white/5 hover:bg-white/10 rounded-lg p-3 border border-white/5 hover:border-white/20 transition-all text-left group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-white text-sm font-medium mb-1",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${s.tagColor} bg-opacity-20 text-white`,children:s.tag}),s.duration>0&&e.jsx("span",{className:"text-xs text-zinc-500 font-mono",children:w(s.duration)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${s.priority==="high"?"bg-red-500":s.priority==="medium"?"bg-blue-500":"bg-green-500"}`}),e.jsx(k,{size:14,className:"text-zinc-600 group-hover:text-zinc-400 transition-colors"})]})]})},s.id))}),n.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-zinc-600 text-sm",children:"No recent tasks"})})]}),e.jsx("div",{className:"p-3 border-t border-white/5 bg-white/[0.02]",children:e.jsx("button",{onClick:()=>{if(window.__TAURI__){window.__TAURI__.window.appWindow.hide();const s=window.__TAURI__.window.WebviewWindow.getByLabel("main");s==null||s.show(),s==null||s.setFocus()}},className:"w-full py-2 px-3 bg-blue-600 hover:bg-blue-500 rounded-lg text-white text-xs font-semibold transition-all",children:"Open Full App"})})]}),T=()=>{const[o,n]=d.useState(null),[i,l]=d.useState([]),[m,c]=d.useState(0),[s,x]=d.useState(u.IDLE);d.useEffect(()=>{const a=localStorage.getItem("focusflow_tasks");if(a)try{l(JSON.parse(a))}catch{console.error("Failed to load tasks")}const t=localStorage.getItem("focusflow_current_task");if(t)try{n(JSON.parse(t))}catch{console.error("Failed to load current task")}const r=localStorage.getItem("focusflow_timer");r&&c(parseInt(r,10));const f=localStorage.getItem("focusflow_status");f&&x(f)},[]),d.useEffect(()=>{let a;return s===u.FOCUSING&&(a=setInterval(()=>{c(t=>{const r=t+1;return localStorage.setItem("focusflow_timer",String(r)),r})},1e3)),()=>clearInterval(a)},[s]),d.useEffect(()=>{const a=t=>{t.key==="focusflow_tasks"&&t.newValue&&l(JSON.parse(t.newValue)),t.key==="focusflow_current_task"&&t.newValue&&n(JSON.parse(t.newValue)),t.key==="focusflow_timer"&&t.newValue&&c(parseInt(t.newValue,10)),t.key==="focusflow_status"&&t.newValue&&x(t.newValue)};return window.addEventListener("storage",a),()=>window.removeEventListener("storage",a)},[]);const p=a=>{const r=i.find(f=>f.name.toLowerCase()===a.toLowerCase())||{id:Math.random().toString(36).substring(7),name:a,tag:"General",tagColor:"bg-green-500",duration:0,lastActive:Date.now(),priority:"medium",completed:!1};n(r),c(r.duration),x(u.FOCUSING),localStorage.setItem("focusflow_current_task",JSON.stringify(r)),localStorage.setItem("focusflow_timer",String(r.duration)),localStorage.setItem("focusflow_status",u.FOCUSING),window.__TAURI__&&window.__TAURI__.window.appWindow.hide()},b=()=>{if(o){const a={...o,duration:m,lastActive:Date.now()},t=i.map(r=>r.id===o.id?a:r);i.find(r=>r.id===o.id)||t.unshift(a),l(t),localStorage.setItem("focusflow_tasks",JSON.stringify(t))}x(u.IDLE),c(0),n(null),localStorage.setItem("focusflow_status",u.IDLE),localStorage.setItem("focusflow_timer","0"),localStorage.removeItem("focusflow_current_task")},N=i.filter(a=>!a.completed).sort((a,t)=>t.lastActive-a.lastActive);return e.jsx("div",{className:"w-screen h-screen bg-transparent",children:e.jsx(C,{currentTask:o,recentTasks:N,timer:m,isActive:s===u.FOCUSING,onStartTask:p,onStopTask:b})})},g=document.getElementById("root");g&&S.createRoot(g).render(e.jsx(I.StrictMode,{children:e.jsx(T,{})}));
